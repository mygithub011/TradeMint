# ğŸš€ Azure DevOps Deployment Guide for Smart Trade Backend

## âœ… Free Tier Available

Azure DevOps: **FREE forever**
Azure App Service: **~$15/month** (or free with student credits)

---

## ğŸ¯ 3-Step Deployment to Azure

### Step 1ï¸âƒ£: Create Azure DevOps Project (2 minutes)

1. Go to **https://dev.azure.com/**
2. Sign in with Microsoft account (create if needed)
3. Click **"Create project"**
4. **Project name**: `smart-trade-backend`
5. **Visibility**: Private
6. Click **"Create"** âœ…

### Step 2ï¸âƒ£: Import GitHub Repository (3 minutes)

1. In your Azure DevOps project â†’ **Repos**
2. Click **"Import repository"**
3. **Repository URL**: `https://github.com/mygithub011/smart-trade-backend.git`
4. Click **"Import"** âœ…

Now your code is in Azure DevOps!

### Step 3ï¸âƒ£: Set Up CI/CD Pipeline (5 minutes)

1. Go to **Pipelines** â†’ **Create Pipeline**
2. Select **GitHub** (or Azure Repos if imported)
3. Select **smart-trade-backend** repository
4. Choose template: **Python to Linux Web App on Azure**
5. Configure:
   - **App name**: `smart-trade-api`
   - **Python version**: `3.12`
6. Click **"Save and run"** âœ…

Pipeline will:
- âœ… Install requirements.txt
- âœ… Run tests (if any)
- âœ… Deploy to Azure App Service
- âœ… Auto-trigger on GitHub push

---

## ğŸ’° Hosting Cost

### Option A: Azure App Service (Recommended)
```
Tier: Basic (B1)
Cost: ~$15/month
Features:
  âœ… Always-on (no spin-down)
  âœ… 24/7 uptime
  âœ… Auto-restart on crash
  âœ… Custom domain support
  âœ… SSL/TLS (free)
```

### Option B: Free Tier (Limited)
```
Tier: Free (F1)
Cost: $0/month
Limitations:
  âš ï¸ Only 1 hour per day
  âš ï¸ No custom domain
  âš ï¸ Shared resources
  âŒ Not suitable for production
```

### Option C: Student/Startup (Free Credits)
```
Get $200 free Azure credits
Covers:
  âœ… B1 App Service for ~13 months
  âœ… Database, storage, etc.
  âœ… No card needed
Check: GitHub Student Pack
```

---

## ğŸ”§ Create Azure App Service

### Quick Setup
1. Go to **https://portal.azure.com/**
2. Click **"Create a resource"**
3. Search: **"App Service"**
4. Click **"Create"**
5. Configure:
   - **Name**: `smart-trade-api`
   - **Publish**: Code
   - **Runtime stack**: Python 3.12
   - **Operating System**: Linux
   - **Region**: East US (or nearest)
   - **App Service Plan**: Create new
     - **Name**: `smart-trade-plan`
     - **SKU**: B1 (Basic) - ~$15/month
6. Click **"Review + create"** â†’ **"Create"** âœ…

---

## âš™ï¸ Configure Environment Variables

In Azure App Service:
1. **Settings** â†’ **Configuration**
2. Add **Application settings**:
   ```
   SECRET_KEY = (auto-generated by Azure)
   DATABASE_URL = sqlite:///./smarttrade.db
   ALGORITHM = HS256
   ACCESS_TOKEN_EXPIRE_MINUTES = 1440
   TELEGRAM_BOT_TOKEN = (your token, optional)
   ```
3. Click **"Save"** âœ…

---

## ğŸ“ Add azure-pipelines.yml to Your Repo

Create file: `azure-pipelines.yml` in repo root

```yaml
trigger:
  - main

pool:
  vmImage: 'ubuntu-latest'

variables:
  pythonVersion: '3.12'

steps:
- task: UsePythonVersion@0
  inputs:
    versionSpec: '$(pythonVersion)'
  displayName: 'Use Python $(pythonVersion)'

- script: |
    python -m pip install --upgrade pip
    pip install -r requirements.txt
  displayName: 'Install dependencies'

- script: |
    python -m pytest --junitxml=junit/test-results.xml 2>/dev/null || true
  displayName: 'Run tests (if any)'

- task: ArchiveFiles@2
  inputs:
    rootFolderOrFile: '$(System.DefaultWorkingDirectory)'
    includeRootFolder: false
    archiveType: 'zip'
    archiveFile: '$(Build.ArtifactStagingDirectory)/$(Build.BuildId).zip'
    replaceExistingArchive: true
  displayName: 'Create deployment package'

- task: PublishBuildArtifacts@1
  inputs:
    pathToPublish: $(Build.ArtifactStagingDirectory)
    artifactName: drop
    publishLocation: 'Container'
  displayName: 'Publish artifacts'

- task: AzureWebApp@1
  inputs:
    azureSubscription: 'Azure subscription'
    appType: 'webAppLinux'
    appName: 'smart-trade-api'
    deploymentMethod: 'zipDeploy'
    package: '$(Build.ArtifactStagingDirectory)/**/*.zip'
  displayName: 'Deploy to Azure App Service'
```

Then:
```bash
git add azure-pipelines.yml
git commit -m "Add Azure DevOps pipeline configuration"
git push origin main
```

---

## âœ… Verify Deployment

### Check Pipeline Status
1. Azure DevOps â†’ **Pipelines**
2. Watch the build & deployment
3. Should complete in 2-3 minutes âœ…

### Test Your Backend
```bash
# Once deployed, it will be at:
https://smart-trade-api.azurewebsites.net

# Test health endpoint
curl https://smart-trade-api.azurewebsites.net/health

# Test API docs
https://smart-trade-api.azurewebsites.net/docs
```

---

## ğŸ”„ Auto-Deploy on GitHub Push

Once set up:
- âœ… Push to GitHub main branch
- âœ… Azure DevOps pipeline triggers automatically
- âœ… Backend redeploys in 2-3 minutes
- âœ… Zero-downtime deployment âœ…

---

## ğŸ’¡ Comparison: Azure vs Render for Long-term

| Aspect | Render Free | Azure App Service |
|--------|------------|-------------------|
| **Cost** | $0 | ~$15/month |
| **Always-On** | âŒ 15 min spin-down | âœ… 24/7 |
| **Cold Start** | 30-60 sec | <1 second |
| **Pipeline** | GitHub Actions | Azure Pipelines |
| **Scaling** | Limited | Auto-scaling available |
| **Best For** | MVP Testing | Production |

---

## ğŸ¯ Deployment Strategy

### Phase 1: MVP Testing (NOW)
```
Use: Render Free
Why: Quick, free, sufficient for testing
Time to deploy: 5 minutes
```

### Phase 2: Early Users
```
Use: Render Starter ($7/mo)
Why: No spin-down, better UX
Time to deploy: 5 minutes (upgrade existing)
```

### Phase 3: Production Ready
```
Use: Azure App Service ($15/mo + free credits)
Why: Professional, always-on, enterprise-grade
Time to deploy: 30-45 minutes (one-time setup)
```

---

## ğŸ“š Resources

| Topic | Link |
|-------|------|
| Azure DevOps | https://dev.azure.com/ |
| Azure Portal | https://portal.azure.com/ |
| App Service Docs | https://learn.microsoft.com/en-us/azure/app-service/ |
| Pipeline Templates | https://learn.microsoft.com/en-us/azure/devops/pipelines/ecosystems/python |

---

## ğŸ‰ Summary

**Azure DevOps is FREE and great for:**
- âœ… Version control
- âœ… CI/CD pipelines
- âœ… Team collaboration
- âœ… Work item tracking

**Azure App Service ($15/mo) is great for:**
- âœ… Always-on backend
- âœ… Professional deployment
- âœ… Better performance
- âœ… Auto-scaling

---

**Decision Time:**
- **A) Deploy to Render Free now** (fastest)
- **B) Set up Azure now** (more professional)
- **C) Start with Render, migrate to Azure later** (best strategy)

What's your preference? ğŸ¤”
